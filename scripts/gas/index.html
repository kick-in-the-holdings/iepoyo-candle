<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iepoyo candle äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ </title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 30px 20px;
            border-radius: 10px 10px 0 0;
            margin: -20px -20px 0;
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 0 -20px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 500;
            margin-bottom: 5px;
            color: #555;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #ff6b6b;
        }
        
        .help-text {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }
        
        /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ« */
        .calendar-container {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .calendar-nav {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .calendar-nav:hover {
            background: #ee5a6f;
        }
        
        .calendar-nav:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .calendar-month {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        
        .calendar-day-header {
            text-align: center;
            font-weight: bold;
            color: #666;
            padding: 10px 0;
            font-size: 14px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .calendar-day:hover:not(.disabled):not(.selected) {
            background: #fff5f5;
            border-color: #ff6b6b;
        }
        
        .calendar-day.disabled {
            color: #ccc;
            cursor: not-allowed;
            background: #f5f5f5;
        }
        
        .calendar-day.selected {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
            font-weight: bold;
        }
        
        .calendar-day.has-slots {
            color: #ff6b6b;
            font-weight: 500;
        }
        
        /* æ™‚é–“é¸æŠ */
        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .time-slot {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        
        .time-slot:hover:not(.selected) {
            border-color: #ff6b6b;
            background: #fff5f5;
        }
        
        .time-slot.selected {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }
        
        .time-slot.disabled {
            background: #f5f5f5;
            color: #ccc;
            cursor: not-allowed;
        }
        
        /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠ */
        .menu-grid {
            display: grid;
            gap: 10px;
        }
        
        .menu-item {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
        }
        
        .menu-item:hover:not(.selected) {
            border-color: #ff6b6b;
            background: #fff5f5;
        }
        
        .menu-item.selected {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }
        
        .menu-item.recommended {
            position: relative;
        }
        
        .menu-item.recommended::after {
            content: 'ãŠã™ã™ã‚';
            position: absolute;
            top: -10px;
            right: 10px;
            background: #ffd700;
            color: #333;
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .menu-price {
            font-weight: bold;
        }
        
        /* ã‚ªãƒ—ã‚·ãƒ§ãƒ³ */
        .option-grid {
            display: grid;
            gap: 10px;
        }
        
        .option-item {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
        }
        
        .option-item:hover {
            border-color: #ff6b6b;
            background: #fff5f5;
        }
        
        .option-item.selected {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }
        
        /* é€ä¿¡ãƒœã‚¿ãƒ³ */
        .submit-button {
            width: 100%;
            padding: 15px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .submit-button:hover {
            background: #ee5a6f;
        }
        
        .submit-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ff6b6b;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .error {
            color: #dc3545;
            font-size: 14px;
            margin-top: 5px;
        }
        
        /* æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .success-message {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }
        
        .success-message.show {
            display: block !important;
        }
        
        .success-message h3 {
            font-size: 28px;
            margin-bottom: 20px;
            color: #ff6b6b;
            font-weight: bold;
        }
        
        .success-message p {
            margin-bottom: 15px;
            line-height: 1.8;
            color: #666;
        }
        
        .success-message .booking-info {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 30px 0;
            text-align: left;
            border: 2px solid #ff6b6b;
            position: relative;
        }
        
        .success-message .booking-info::before {
            content: 'ğŸ“‹';
            position: absolute;
            top: -15px;
            left: 20px;
            background: white;
            padding: 0 10px;
            font-size: 24px;
        }
        
        .success-message .booking-info h4 {
            color: #ff6b6b;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .success-message .booking-info p {
            margin-bottom: 10px;
            color: #333;
            font-size: 16px;
        }
        
        .email-warning {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 2px solid #ffc107;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
            position: relative;
            text-align: left;
        }
        
        .email-warning::before {
            content: 'âš ï¸';
            position: absolute;
            top: -15px;
            left: 20px;
            background: white;
            padding: 0 10px;
            font-size: 24px;
        }
        
        .email-warning h5 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .email-warning p {
            margin: 5px 0;
            color: #856404;
            font-size: 15px;
        }
        
        .email-warning .email-address {
            background: white;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .social-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .social-section h4 {
            color: #ff6b6b;
            margin-bottom: 20px;
            font-size: 22px;
        }
        
        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .social-link {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            background: white;
            border-radius: 50px;
            text-decoration: none;
            color: #333;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-weight: 500;
        }
        
        .social-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        
        .social-link.line {
            background: #00B900;
            color: white;
        }
        
        .social-link.instagram {
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            color: white;
        }
        
        .social-link.homepage {
            background: #ff6b6b;
            color: white;
        }
        
        .social-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
        }
        
        .final-message {
            background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            border: 1px solid #ffcccc;
        }
        
        .final-message p {
            color: #666;
            font-size: 16px;
            margin: 10px 0;
        }
        
        .success-icon {
            font-size: 80px;
            color: #28a745;
            margin-bottom: 20px;
            animation: bounce 1s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-20px);
            }
            60% {
                transform: translateY(-10px);
            }
        }
        
        @media (max-width: 768px) {
            .social-links {
                flex-direction: column;
                align-items: center;
            }
            
            .social-link {
                width: 80%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>iepoyo candle äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ </h1>
            <p>æ‰‹ä½œã‚Šã‚­ãƒ£ãƒ³ãƒ‰ãƒ«ä½“é¨“ã®ã”äºˆç´„</p>
        </div>
        
        <div class="form-container">
            <form id="bookingForm">
                <!-- é€£çµ¡å…ˆæƒ…å ± -->
                <div class="section">
                    <h2 class="section-title">é€£çµ¡å…ˆæƒ…å ±</h2>
                    
                    <div class="form-group">
                        <label for="name">ä»£è¡¨è€…æ°å <span style="color: red;">*</span></label>
                        <input type="text" id="name" name="name" required>
                        <div class="help-text">ã”äºˆç´„ä»£è¡¨è€…ã®ãŠåå‰ã‚’ãƒ•ãƒ«ãƒãƒ¼ãƒ ã§ã”è¨˜å…¥ãã ã•ã„</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span style="color: red;">*</span></label>
                        <input type="email" id="email" name="email" required>
                        <div class="help-text">äºˆç´„ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’ãŠé€ã‚Šã—ã¾ã™</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">é›»è©±ç•ªå· <span style="color: red;">*</span></label>
                        <input type="tel" id="phone" name="phone" pattern="[0-9]{10,11}" required>
                        <div class="help-text">ãƒã‚¤ãƒ•ãƒ³ãªã—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼š09012345678ï¼‰</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="participants">å‚åŠ äººæ•° <span style="color: red;">*</span></label>
                        <input type="number" id="participants" name="participants" min="1" max="10" required>
                        <div class="help-text">ä½“é¨“ã•ã‚Œã‚‹äººæ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                    </div>
                </div>
                
                <!-- æ—¥æ™‚é¸æŠ -->
                <div class="section">
                    <h2 class="section-title">ã”å¸Œæœ›ã®æ—¥æ™‚</h2>
                    
                    <div class="form-group">
                        <label>æ—¥ä»˜ã‚’é¸æŠ <span style="color: red;">*</span></label>
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <button type="button" class="calendar-nav" id="prevMonth">&lt;</button>
                                <div class="calendar-month" id="currentMonth">2024å¹´12æœˆ</div>
                                <button type="button" class="calendar-nav" id="nextMonth">&gt;</button>
                            </div>
                            <div class="calendar-grid" id="calendar">
                                <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯JavaScriptã§ç”Ÿæˆ -->
                            </div>
                        </div>
                        <input type="hidden" id="selectedDate" name="selectedDate" required>
                    </div>
                    
                    <div class="form-group" id="timeSlotGroup" style="display: none;">
                        <label>æ™‚é–“å¸¯ã‚’é¸æŠ <span style="color: red;">*</span></label>
                        <div class="time-slots" id="timeSlots">
                            <!-- æ™‚é–“å¸¯ã¯JavaScriptã§ç”Ÿæˆ -->
                        </div>
                        <input type="hidden" id="selectedTime" name="selectedTime" required>
                    </div>
                </div>
                
                <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠ -->
                <div class="section">
                    <h2 class="section-title">ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠ</h2>
                    
                    <div class="form-group">
                        <label>ä½“é¨“ãƒ¡ãƒ‹ãƒ¥ãƒ¼ <span style="color: red;">*</span></label>
                        <div class="menu-grid" id="menuItems">
                            <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯JavaScriptã§ç”Ÿæˆ -->
                        </div>
                        <input type="hidden" id="selectedMenu" name="selectedMenu" required>
                    </div>
                    
                    <div class="form-group">
                        <label>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
                        <div class="option-grid" id="optionItems">
                            <!-- ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯JavaScriptã§ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- å‚™è€ƒ -->
                <div class="section">
                    <h2 class="section-title">ãã®ä»–</h2>
                    
                    <div class="form-group">
                        <label for="remarks">å‚™è€ƒãƒ»ã”è¦æœ›</label>
                        <textarea id="remarks" name="remarks" rows="4"></textarea>
                        <div class="help-text">ãã®ä»–ã”è¦æœ›ãªã©ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã”è¨˜å…¥ãã ã•ã„</div>
                    </div>
                </div>
                
                <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
                <button type="submit" class="submit-button" id="submitButton">äºˆç´„ã‚’ç¢ºå®šã™ã‚‹</button>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>äºˆç´„ã‚’å‡¦ç†ã—ã¦ã„ã¾ã™...</p>
                </div>
                
                <div class="success-message" id="successMessage">
                    <div class="success-icon">âœ…</div>
                    <h3>ğŸ‰ ã”äºˆç´„ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼</h3>
                    <p style="font-size: 18px; color: #333;">
                        iepoyo candleã§ã®ã‚­ãƒ£ãƒ³ãƒ‰ãƒ«ä½œã‚Šä½“é¨“ã®ã”äºˆç´„ã‚’<br>
                        ç¢ºã‹ã«æ‰¿ã‚Šã¾ã—ãŸã€‚
                    </p>
                    
                    <div class="booking-info" id="bookingConfirmation">
                        <h4>ã”äºˆç´„å†…å®¹</h4>
                        <p id="confirmDate">æ—¥æ™‚: </p>
                        <p id="confirmName">ãŠåå‰: </p>
                        <p id="confirmParticipants">å‚åŠ äººæ•°: </p>
                        <p id="confirmMenu">ãƒ¡ãƒ‹ãƒ¥ãƒ¼: </p>
                        <p id="confirmTotal" style="font-size: 18px; font-weight: bold; color: #ff6b6b;">åˆè¨ˆé‡‘é¡: </p>
                    </div>
                    
                    <div class="email-warning">
                        <h5>ğŸ“§ ç¢ºèªãƒ¡ãƒ¼ãƒ«ã«ã¤ã„ã¦é‡è¦ãªãŠçŸ¥ã‚‰ã›</h5>
                        <p>äºˆç´„ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚</p>
                        <p><strong>å¿…ãšã”ç¢ºèªãã ã•ã„ï¼š</strong></p>
                        <p>âœ‰ï¸ ãƒ¡ãƒ¼ãƒ«ãŒå±Šã‹ãªã„å ´åˆã¯<strong>è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ«ãƒ€</strong>ã‚’ã”ç¢ºèªãã ã•ã„</p>
                        <p>ğŸ—‘ï¸ <strong>ã‚´ãƒŸç®±</strong>ã«æŒ¯ã‚Šåˆ†ã‘ã‚‰ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™</p>
                        <p>ğŸ“Œ ä»Šå¾Œã®ãŸã‚ã« <span class="email-address">iepoyocandle@gmail.com</span> ã‚’é€£çµ¡å…ˆã«è¿½åŠ ã—ã¦ãã ã•ã„</p>
                    </div>
                    
                    <div class="social-section">
                        <h4>ğŸ•¯ï¸ iepoyo candleã‚’ã‚‚ã£ã¨çŸ¥ã‚‹</h4>
                        <p style="margin-bottom: 20px;">
                            æœ€æ–°æƒ…å ±ã‚„ã‚­ãƒ£ãƒ³ãƒ‰ãƒ«ä½œå“ã‚’ãƒã‚§ãƒƒã‚¯ï¼<br>
                            ãœã²ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„â™ª
                        </p>
                        
                        <div class="social-links">
                            <a href="https://lin.ee/k0N5obP" 
                               class="social-link line" 
                               target="_blank">
                                <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM16.84 14.32C16.84 14.32 15.54 15.68 15.29 15.95C15.02 16.25 14.71 16.25 14.38 16.02C13.72 15.56 13.06 15.02 12.46 14.42C11.86 13.82 11.32 13.16 10.86 12.5C10.63 12.17 10.63 11.86 10.93 11.59C11.2 11.32 11.48 11.05 11.75 10.78C11.84 10.69 11.84 10.6 11.75 10.51L10.46 8.64C10.37 8.46 10.28 8.46 10.1 8.55C9.56 8.91 9.02 9.35 8.57 9.8C8.3 10.07 8.3 10.43 8.48 10.79C9.38 12.68 10.64 14.3 12.35 15.56C12.71 15.83 13.07 15.83 13.43 15.56C13.88 15.11 14.32 14.57 14.68 14.03C14.77 13.94 14.77 13.85 14.68 13.76L12.81 12.47C12.72 12.38 12.63 12.38 12.54 12.47C12.27 12.74 12 13.01 11.73 13.28C11.64 13.37 11.55 13.37 11.46 13.28C11.1 12.92 10.74 12.56 10.38 12.2C10.29 12.11 10.29 12.02 10.38 11.93C10.65 11.66 10.92 11.39 11.19 11.12C11.28 11.03 11.28 10.94 11.19 10.85L9.9 9.56C9.81 9.47 9.72 9.47 9.63 9.56C9.09 10.1 8.55 10.73 8.1 11.36C7.65 11.99 7.65 12.71 8.1 13.34C8.91 14.51 9.9 15.5 11.07 16.31C11.7 16.76 12.42 16.76 13.05 16.31C13.68 15.86 14.31 15.32 14.85 14.78C14.94 14.69 14.94 14.6 14.85 14.51L13.56 13.22C13.47 13.13 13.38 13.13 13.29 13.22C13.02 13.49 12.75 13.76 12.48 14.03C12.39 14.12 12.3 14.12 12.21 14.03C11.85 13.67 11.49 13.31 11.13 12.95C11.04 12.86 11.04 12.77 11.13 12.68C11.4 12.41 11.67 12.14 11.94 11.87C12.03 11.78 12.03 11.69 11.94 11.6L10.65 10.31C10.56 10.22 10.47 10.22 10.38 10.31C9.84 10.85 9.3 11.48 8.85 12.11C8.58 12.47 8.58 12.92 8.85 13.28L10.14 14.57C10.23 14.66 10.32 14.66 10.41 14.57C10.68 14.3 10.95 14.03 11.22 13.76C11.31 13.67 11.4 13.67 11.49 13.76C11.85 14.12 12.21 14.48 12.57 14.84C12.66 14.93 12.66 15.02 12.57 15.11C12.3 15.38 12.03 15.65 11.76 15.92C11.67 16.01 11.58 16.01 11.49 15.92L10.2 14.63C10.11 14.54 10.02 14.54 9.93 14.63C9.39 15.17 8.85 15.8 8.4 16.43C8.13 16.79 8.13 17.24 8.4 17.6C8.76 17.96 9.12 18.32 9.48 18.68C9.84 19.04 10.29 19.04 10.65 18.68C11.28 18.05 11.91 17.42 12.45 16.7C12.54 16.61 12.63 16.61 12.72 16.7L14.59 18.57C14.68 18.66 14.77 18.66 14.86 18.57C15.4 18.03 15.94 17.4 16.39 16.77C16.66 16.41 16.66 15.96 16.39 15.6L15.1 14.31C15.01 14.22 14.92 14.22 14.83 14.31C14.83 14.31 16.84 14.32 16.84 14.32Z"/>
                                </svg>
                                LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
                            </a>
                            
                            <a href="https://www.instagram.com/iepoyo.miyako/" 
                               class="social-link instagram" 
                               target="_blank">
                                <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zM5.838 12a6.162 6.162 0 1 1 12.324 0 6.162 6.162 0 0 1-12.324 0zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm4.965-10.405a1.44 1.44 0 1 1 2.881.001 1.44 1.44 0 0 1-2.881-.001z"/>
                                </svg>
                                Instagram
                            </a>
                            
                            <a href="https://kick-in-the-holdings.github.io/iepoyo-candle/" 
                               class="social-link homepage" 
                               target="_blank">
                                <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                                </svg>
                                å…¬å¼ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸
                            </a>
                        </div>
                    </div>
                    
                    <div class="final-message">
                        <p>ğŸ•¯ï¸ <strong>å½“æ—¥ã®ã”æ¡ˆå†…</strong></p>
                        <p>ãƒ»é–‹å§‹æ™‚åˆ»ã®5åˆ†å‰ã¾ã§ã«ãŠè¶Šã—ãã ã•ã„</p>
                        <p>ãƒ»ã‚¨ãƒ—ãƒ­ãƒ³ã¯ç„¡æ–™ã§è²¸ã—å‡ºã—ã„ãŸã—ã¾ã™</p>
                        <p>ãƒ»ä½œå“ã¯å½“æ—¥ãŠæŒã¡å¸°ã‚Šã„ãŸã ã‘ã¾ã™</p>
                        <p>ãƒ»ãŠæ”¯æ‰•ã„ã¯ç¾åœ°ã«ã¦ç¾é‡‘ã§ãŠé¡˜ã„ã„ãŸã—ã¾ã™</p>
                        <br>
                        <p style="font-size: 18px; text-align: center;">
                            <strong>ç´ æ•µãªã‚­ãƒ£ãƒ³ãƒ‰ãƒ«ä½œã‚Šã®æ™‚é–“ã‚’<br>
                            ä¸€ç·’ã«æ¥½ã—ã¿ã¾ã—ã‚‡ã†ï¼âœ¨</strong>
                        </p>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentDate = new Date();
        let selectedDate = null;
        let selectedTime = null;
        let selectedMenu = null;
        let selectedOptions = [];
        let availableDates = {};
        
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼æƒ…å ±
        const MENU_ITEMS = [
            { name: 'ãƒãƒ¼ãƒ–ãƒ«ã‚­ãƒ£ãƒ³ãƒ‰ãƒ«', price: 2500 },
            { name: 'è²æ®»ã‚­ãƒ£ãƒ³ãƒ‰ãƒ«', price: 3000 },
            { name: 'çƒä½“ã‚­ãƒ£ãƒ³ãƒ‰ãƒ«', price: 3500, recommended: true },
            { name: 'çƒä½“ã‚­ãƒ£ãƒ³ãƒ‰ãƒ«(Big)', price: 5000 }
        ];
        
        const OPTION_ITEMS = [
            { name: 'ãƒ©ãƒ¡', price: 500 },
            { name: 'é‡‘ç®”', price: 500 },
            { name: 'ã‚¨ãƒƒã‚»ãƒ³ã‚·ãƒ£ãƒ«ã‚ªã‚¤ãƒ«', price: 500 }
        ];
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeCalendar();
            initializeMenus();
            setupEventListeners();
            loadAvailableDates();
            
            // iframeå†…ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã€é«˜ã•æƒ…å ±ã‚’è¦ªã«é€ä¿¡
            if (window.parent !== window) {
                sendHeightToParent();
                // å†…å®¹ãŒå¤‰ã‚ã£ãŸã¨ãã«é«˜ã•ã‚’å†é€ä¿¡
                const observer = new MutationObserver(sendHeightToParent);
                observer.observe(document.body, {
                    childList: true,
                    subtree: true,
                    attributes: true
                });
            }
        });
        
        // è¦ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«é«˜ã•ã‚’é€ä¿¡
        function sendHeightToParent() {
            if (window.parent !== window) {
                const height = document.body.scrollHeight;
                window.parent.postMessage({
                    type: 'resize',
                    height: height
                }, '*');
            }
        }
        
        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®åˆæœŸåŒ–
        function initializeCalendar() {
            renderCalendar();
        }
        
        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // æœˆã®è¡¨ç¤ºã‚’æ›´æ–°
            document.getElementById('currentMonth').textContent = 
                `${year}å¹´${month + 1}æœˆ`;
            
            // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚°ãƒªãƒƒãƒ‰ã‚’ã‚¯ãƒªã‚¢
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';
            
            // æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼
            const dayHeaders = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day-header';
                header.textContent = day;
                calendar.appendChild(header);
            });
            
            // æœˆã®æœ€åˆã®æ—¥ã¨æœ€å¾Œã®æ—¥ã‚’å–å¾—
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // æœ€åˆã®é€±ã®ç©ºç™½
            for (let i = 0; i < firstDay.getDay(); i++) {
                const emptyDay = document.createElement('div');
                calendar.appendChild(emptyDay);
            }
            
            // æ—¥ä»˜ã‚’ç”Ÿæˆ
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                const dateObj = new Date(year, month, day);
                const dateStr = formatDateForKey(dateObj);
                
                // éå»ã®æ—¥ä»˜ã¯ç„¡åŠ¹åŒ–
                if (dateObj < today) {
                    dayElement.classList.add('disabled');
                } else if (availableDates[dateStr]) {
                    dayElement.classList.add('has-slots');
                    dayElement.onclick = () => selectDate(dateObj);
                } else {
                    dayElement.onclick = () => selectDate(dateObj);
                }
                
                // é¸æŠã•ã‚ŒãŸæ—¥ä»˜ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                if (selectedDate && 
                    selectedDate.getDate() === day && 
                    selectedDate.getMonth() === month && 
                    selectedDate.getFullYear() === year) {
                    dayElement.classList.add('selected');
                }
                
                calendar.appendChild(dayElement);
            }
        }
        
        // æ—¥ä»˜é¸æŠ
        function selectDate(date) {
            selectedDate = date;
            renderCalendar();
            
            document.getElementById('selectedDate').value = formatDateForKey(date);
            
            // æ™‚é–“å¸¯ã‚’èª­ã¿è¾¼ã¿
            loadTimeSlots(date);
        }
        
        // æ™‚é–“å¸¯ã®èª­ã¿è¾¼ã¿
        function loadTimeSlots(date) {
            const timeSlotGroup = document.getElementById('timeSlotGroup');
            const timeSlotsContainer = document.getElementById('timeSlots');
            
            timeSlotGroup.style.display = 'block';
            timeSlotsContainer.innerHTML = '<p>èª­ã¿è¾¼ã¿ä¸­...</p>';
            
            // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰åˆ©ç”¨å¯èƒ½ãªæ™‚é–“å¸¯ã‚’å–å¾—
            google.script.run
                .withSuccessHandler(function(slots) {
                    renderTimeSlots(slots);
                })
                .withFailureHandler(function(error) {
                    timeSlotsContainer.innerHTML = '<p style="color: red;">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p>';
                })
                .getAvailableTimeSlotsForDateAjax(formatDateForKey(date));
        }
        
        // æ™‚é–“å¸¯ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        function renderTimeSlots(slots) {
            const container = document.getElementById('timeSlots');
            container.innerHTML = '';
            
            if (slots.length === 0) {
                container.innerHTML = '<p>ã“ã®æ—¥ã¯äºˆç´„ã§ãã‚‹æ™‚é–“å¸¯ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }
            
            slots.forEach(slot => {
                const slotElement = document.createElement('div');
                slotElement.className = 'time-slot';
                slotElement.textContent = slot;
                slotElement.onclick = () => selectTimeSlot(slot, slotElement);
                container.appendChild(slotElement);
            });
        }
        
        // æ™‚é–“å¸¯é¸æŠ
        function selectTimeSlot(time, element) {
            // ä»¥å‰ã®é¸æŠã‚’ã‚¯ãƒªã‚¢
            document.querySelectorAll('.time-slot').forEach(el => {
                el.classList.remove('selected');
            });
            
            element.classList.add('selected');
            selectedTime = time;
            document.getElementById('selectedTime').value = time;
        }
        
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®åˆæœŸåŒ–
        function initializeMenus() {
            // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼
            const menuContainer = document.getElementById('menuItems');
            MENU_ITEMS.forEach(item => {
                const menuElement = document.createElement('div');
                menuElement.className = 'menu-item';
                if (item.recommended) {
                    menuElement.classList.add('recommended');
                }
                menuElement.innerHTML = `
                    <span>${item.name}</span>
                    <span class="menu-price">Â¥${item.price.toLocaleString()}</span>
                `;
                menuElement.onclick = () => selectMenu(item, menuElement);
                menuContainer.appendChild(menuElement);
            });
            
            // ã‚ªãƒ—ã‚·ãƒ§ãƒ³
            const optionContainer = document.getElementById('optionItems');
            OPTION_ITEMS.forEach(item => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option-item';
                optionElement.innerHTML = `
                    <span>${item.name}</span>
                    <span>Â¥${item.price}</span>
                `;
                optionElement.onclick = () => toggleOption(item, optionElement);
                optionContainer.appendChild(optionElement);
            });
        }
        
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠ
        function selectMenu(menu, element) {
            document.querySelectorAll('.menu-item').forEach(el => {
                el.classList.remove('selected');
            });
            
            element.classList.add('selected');
            selectedMenu = menu;
            document.getElementById('selectedMenu').value = 
                `${menu.name}ï¼š${menu.price}å††`;
        }
        
        // ã‚ªãƒ—ã‚·ãƒ§ãƒ³é¸æŠ
        function toggleOption(option, element) {
            if (element.classList.contains('selected')) {
                element.classList.remove('selected');
                selectedOptions = selectedOptions.filter(o => o.name !== option.name);
            } else {
                element.classList.add('selected');
                selectedOptions.push(option);
            }
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function setupEventListeners() {
            // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
            document.getElementById('prevMonth').onclick = () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            };
            
            document.getElementById('nextMonth').onclick = () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            };
            
            // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
            document.getElementById('bookingForm').onsubmit = (e) => {
                e.preventDefault();
                submitForm();
            };
        }
        
        // åˆ©ç”¨å¯èƒ½ãªæ—¥ä»˜ã‚’èª­ã¿è¾¼ã¿
        function loadAvailableDates() {
            google.script.run
                .withSuccessHandler(function(dates) {
                    dates.forEach(date => {
                        availableDates[date.value] = true;
                    });
                    renderCalendar();
                })
                .withFailureHandler(function(error) {
                    console.error('æ—¥ä»˜ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                })
                .getAvailableDates();
        }
        
        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        function submitForm() {
            console.log('submitFormé–‹å§‹');
            
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                participants: document.getElementById('participants').value,
                date: formatDateForDisplay(selectedDate),
                time: selectedTime,
                menu: selectedMenu,
                options: selectedOptions,
                remarks: document.getElementById('remarks').value
            };
            
            console.log('é€ä¿¡ãƒ‡ãƒ¼ã‚¿:', formData);
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            document.getElementById('submitButton').disabled = true;
            document.getElementById('loading').classList.add('show');
            
            // ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
            google.script.run
                .withSuccessHandler(function(result) {
                    console.log('äºˆç´„æˆåŠŸ:', result);
                    
                    // åˆè¨ˆé‡‘é¡ã‚’è¨ˆç®—
                    const menuPrice = formData.menu.price;
                    const participantCount = parseInt(formData.participants);
                    const optionCount = formData.options.length;
                    const totalPrice = (menuPrice * participantCount) + 
                                     (optionCount * 500 * participantCount);
                    
                    // äºˆç´„æƒ…å ±ã‚’ã¾ã¨ã‚ã‚‹
                    const bookingInfo = {
                        date: formData.date,
                        time: formData.time,
                        name: formData.name,
                        participants: formData.participants,
                        menu: formData.menu.name,
                        total: totalPrice.toLocaleString()
                    };
                    
                    // iframeå†…ã‹ã‚‰è¦ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
                    if (window.parent !== window) {
                        console.log('è¦ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡');
                        window.parent.postMessage({
                            type: 'bookingComplete',
                            bookingInfo: bookingInfo
                        }, '*');
                    } else {
                        // ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã®å ´åˆã¯ã€æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                        document.getElementById('loading').classList.remove('show');
                        document.getElementById('bookingForm').style.display = 'none';
                        
                        // äºˆç´„å†…å®¹ã‚’è¡¨ç¤º
                        document.getElementById('confirmDate').textContent = 
                            `æ—¥æ™‚: ${formData.date} ${formData.time}`;
                        document.getElementById('confirmName').textContent = 
                            `ãŠåå‰: ${formData.name}æ§˜`;
                        document.getElementById('confirmParticipants').textContent = 
                            `å‚åŠ äººæ•°: ${formData.participants}å`;
                        document.getElementById('confirmMenu').textContent = 
                            `ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ${formData.menu.name}`;
                        document.getElementById('confirmTotal').textContent = 
                            `åˆè¨ˆé‡‘é¡: Â¥${totalPrice.toLocaleString()}`;
                        
                        // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                        document.getElementById('successMessage').classList.add('show');
                        document.getElementById('successMessage').style.display = 'block';
                        
                        // ãƒšãƒ¼ã‚¸ãƒˆãƒƒãƒ—ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                })
                .withFailureHandler(function(error) {
                    console.error('äºˆç´„ã‚¨ãƒ©ãƒ¼:', error);
                    document.getElementById('loading').classList.remove('show');
                    document.getElementById('submitButton').disabled = false;
                    alert('äºˆç´„ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚\nã‚¨ãƒ©ãƒ¼: ' + error);
                })
                .processBooking(formData);
        }
        
        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆã‚­ãƒ¼ç”¨ï¼‰
        function formatDateForKey(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆè¡¨ç¤ºç”¨ï¼‰
        function formatDateForDisplay(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const dayOfWeek = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'][date.getDay()];
            return `${year}å¹´${month}æœˆ${day}æ—¥ï¼ˆ${dayOfWeek}ï¼‰`;
        }
    </script>
</body>
</html>